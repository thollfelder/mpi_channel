<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI_Channel: src/RMA/MPSC/RMA_MPSC_SYNC.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI_Channel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_957240939c41b3e0b90ba346b14c999c.html">RMA</a></li><li class="navelem"><a class="el" href="dir_4b2ea471cdcd5efc43fc1a300eb7e159.html">MPSC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">RMA_MPSC_SYNC.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header of RMA MPSC SYNC Channel.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_m_p_i___channel___struct_8h_source.html">../../MPI_Channel_Struct.h</a>&quot;</code><br />
</div>
<p><a href="_r_m_a___m_p_s_c___s_y_n_c_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6615c00e05857604e0b10d6d925b13ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a6615c00e05857604e0b10d6d925b13ab">channel_alloc_rma_mpsc_sync</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch)</td></tr>
<tr class="memdesc:a6615c00e05857604e0b10d6d925b13ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the properties of a passed <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type RMA MPSC SYNC and returns it.  <a href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a6615c00e05857604e0b10d6d925b13ab">More...</a><br /></td></tr>
<tr class="separator:a6615c00e05857604e0b10d6d925b13ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa4424cafe6cd94d4187ea0b88cb4c16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#aaa4424cafe6cd94d4187ea0b88cb4c16">channel_send_rma_mpsc_sync</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch, void *data)</td></tr>
<tr class="memdesc:aaa4424cafe6cd94d4187ea0b88cb4c16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> starting at the adress the void pointer holds into the channel. <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#aaa4424cafe6cd94d4187ea0b88cb4c16" title="Sends the numbers of bytes of a data element specified in channel_alloc() starting at the adress the ...">channel_send_rma_mpsc_sync()</a> blocks until a matching <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a3aca98ca3ae0dd793851f455f7af74f4" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive_rma_mpsc_sync()</a> is called.  <a href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#aaa4424cafe6cd94d4187ea0b88cb4c16">More...</a><br /></td></tr>
<tr class="separator:aaa4424cafe6cd94d4187ea0b88cb4c16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aca98ca3ae0dd793851f455f7af74f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a3aca98ca3ae0dd793851f455f7af74f4">channel_receive_rma_mpsc_sync</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch, void *data)</td></tr>
<tr class="memdesc:a3aca98ca3ae0dd793851f455f7af74f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> from the channel and stores them starting at the adress the void pointer holds. <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a3aca98ca3ae0dd793851f455f7af74f4" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive_rma_mpsc_sync()</a> blocks until a matching <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#aaa4424cafe6cd94d4187ea0b88cb4c16" title="Sends the numbers of bytes of a data element specified in channel_alloc() starting at the adress the ...">channel_send_rma_mpsc_sync()</a> is called.  <a href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a3aca98ca3ae0dd793851f455f7af74f4">More...</a><br /></td></tr>
<tr class="separator:a3aca98ca3ae0dd793851f455f7af74f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24abe77ffad897a3764315b26d0c748b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a24abe77ffad897a3764315b26d0c748b">channel_free_rma_mpsc_sync</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch)</td></tr>
<tr class="memdesc:a24abe77ffad897a3764315b26d0c748b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates the channel and all allocated members.  <a href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a24abe77ffad897a3764315b26d0c748b">More...</a><br /></td></tr>
<tr class="separator:a24abe77ffad897a3764315b26d0c748b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header of RMA MPSC SYNC Channel. </p>
<dl class="section author"><dt>Author</dt><dd>Toni Hollfelder (<a href="#" onclick="location.href='mai'+'lto:'+'Ton'+'i.'+'Hol'+'lf'+'eld'+'er'+'@un'+'i-'+'bay'+'re'+'uth'+'.d'+'e'; return false;">Toni.<span style="display: none;">.nosp@m.</span>Holl<span style="display: none;">.nosp@m.</span>felde<span style="display: none;">.nosp@m.</span>r@un<span style="display: none;">.nosp@m.</span>i-bay<span style="display: none;">.nosp@m.</span>reut<span style="display: none;">.nosp@m.</span>h.de</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-05-24 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>CC BY 4.0 (<a href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a>)</dd></dl>
<p>This RMA MPSC SYNC channel implementation use passive target communication and especially a distributed lock (implemented as a single linked list). The key idea behind this implementation is to use the lock to determine a sender which will execute the synchronous data exchange with the single receiver. This implementation ensures fairness and a starvation-freeness: It is impossible for one process to starve due to the alternating lock acquisition.</p>
<p>Layout of local window memory of each process depending on sender or receiver process: Sender: | SPIN_1 | SPIN_2 | NEXT_SENDER | Receiver: | CURRENT_SENDER | LATEST_SENDER | DATA |</p>
<p>The lock is located at the single receiver process. To get the lock the sender process atomically exchanges the latest sender rank at the receiver window with its own rank. If it has stored the initial value -1 the calling sender has the lock since no other sender has tried to acquire the lock before. If another sender process has the lock the calling sender process registers at the sender stored in the latest sender variable and spins over one of its local variables until it gets woken up by the sender process it registered to. After acquiring the lock the sender process sends the data to the receiver process and writes its rank into the current sender variable at the receiver rank. It then spins over the second variable waiting to be woken up by the receiver. Before returning the lock the sender process needs to wake the next sender process up but only if another sender process has registered.</p>
<p>Why using passive target communication over MPI_Fence and MPI_{Post|Start|Complete|Wait}?</p><ul>
<li>MPI_Win_fence can not be used because its collective over all processes used in the window creation. One would have to create a window + communicator for every receiver-sender pair. However there is no function to test if another process has called MPI_Win_fence (similar to MPI_Test). This means that the approach of iterating over all sender is not possible</li>
<li>MPI_{Post|Wait|Start|Complete} indeed allows the communication between groups of processes within a communicator but MPI does not state anything about the order of executions of access epochs. This means that one sender process could be potentially always preferred. Thus for a starvation-free and fair implementation MPI PSCW cannot be used. <br  />
 </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6615c00e05857604e0b10d6d925b13ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6615c00e05857604e0b10d6d925b13ab">&#9670;&nbsp;</a></span>channel_alloc_rma_mpsc_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a>* channel_alloc_rma_mpsc_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the properties of a passed <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type RMA MPSC SYNC and returns it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> allocated with <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to a valid <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> with updated properties if updating was successful and NULL otherwise </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns NULL if MPI related functions or allocation memory failure happend. </dd></dl>

</div>
</div>
<a id="a24abe77ffad897a3764315b26d0c748b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24abe77ffad897a3764315b26d0c748b">&#9670;&nbsp;</a></span>channel_free_rma_mpsc_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_free_rma_mpsc_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates the channel and all allocated members. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type RMA MPSC SYNC <br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 since deallocation is always successful </dd></dl>

</div>
</div>
<a id="a3aca98ca3ae0dd793851f455f7af74f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aca98ca3ae0dd793851f455f7af74f4">&#9670;&nbsp;</a></span>channel_receive_rma_mpsc_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_receive_rma_mpsc_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> from the channel and stores them starting at the adress the void pointer holds. <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a3aca98ca3ae0dd793851f455f7af74f4" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive_rma_mpsc_sync()</a> blocks until a matching <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#aaa4424cafe6cd94d4187ea0b88cb4c16" title="Sends the numbers of bytes of a data element specified in channel_alloc() starting at the adress the ...">channel_send_rma_mpsc_sync()</a> is called. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type RMA MPSC SYNC <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Pointer to a memory adress of which size bytes will be received to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if receiving was successful, -1 otherwise </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns -1 if internal problems with MPI related functions happend </dd></dl>

</div>
</div>
<a id="aaa4424cafe6cd94d4187ea0b88cb4c16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa4424cafe6cd94d4187ea0b88cb4c16">&#9670;&nbsp;</a></span>channel_send_rma_mpsc_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_send_rma_mpsc_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> starting at the adress the void pointer holds into the channel. <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#aaa4424cafe6cd94d4187ea0b88cb4c16" title="Sends the numbers of bytes of a data element specified in channel_alloc() starting at the adress the ...">channel_send_rma_mpsc_sync()</a> blocks until a matching <a class="el" href="_r_m_a___m_p_s_c___s_y_n_c_8h.html#a3aca98ca3ae0dd793851f455f7af74f4" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive_rma_mpsc_sync()</a> is called. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type RMA MPSC SYNC <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to a memory adress of which size bytes will be sent from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if sending was successful, -1 otherwise </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns -1 if internal problems with MPI related functions happend </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
