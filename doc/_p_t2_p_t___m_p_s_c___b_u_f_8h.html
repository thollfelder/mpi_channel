<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI_Channel: src/PT2PT/MPSC/PT2PT_MPSC_BUF.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI_Channel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fec7a3cd808021bbc737abc73229fa6c.html">PT2PT</a></li><li class="navelem"><a class="el" href="dir_02609d2f3c4b0398745310ffeb440ffb.html">MPSC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">PT2PT_MPSC_BUF.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header of PT2PT MPSC BUF Channel.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_m_p_i___channel___struct_8h_source.html">../../MPI_Channel_Struct.h</a>&quot;</code><br />
</div>
<p><a href="_p_t2_p_t___m_p_s_c___b_u_f_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a642dc8e94d264c52eee124c07f20796f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a642dc8e94d264c52eee124c07f20796f">channel_alloc_pt2pt_mpsc_buf</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch)</td></tr>
<tr class="memdesc:a642dc8e94d264c52eee124c07f20796f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the properties of a passed <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type PT2PT MPSC BUF and returns it.  <a href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a642dc8e94d264c52eee124c07f20796f">More...</a><br /></td></tr>
<tr class="separator:a642dc8e94d264c52eee124c07f20796f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad089f57ac83ba8704b352fff962c4caa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ad089f57ac83ba8704b352fff962c4caa">channel_send_pt2pt_mpsc_buf</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch, void *data)</td></tr>
<tr class="memdesc:ad089f57ac83ba8704b352fff962c4caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> starting at the adress the void pointer holds into the channel. Calling <a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ad089f57ac83ba8704b352fff962c4caa" title="Sends the numbers of bytes of a data element specified in channel_alloc() starting at the adress the ...">channel_send_pt2pt_mpsc_buf()</a> blocks only if the channel buffer has reached the channel capacity.  <a href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ad089f57ac83ba8704b352fff962c4caa">More...</a><br /></td></tr>
<tr class="separator:ad089f57ac83ba8704b352fff962c4caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61480c2f471e5621b7322b555b8b59c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ae61480c2f471e5621b7322b555b8b59c">channel_receive_pt2pt_mpsc_buf</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch, void *data)</td></tr>
<tr class="memdesc:ae61480c2f471e5621b7322b555b8b59c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> from the channel and stores them starting at the adress the void pointer holds. Calling <a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ae61480c2f471e5621b7322b555b8b59c" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive_pt2pt_mpsc_buf()</a> blocks only if no element has arrived and the internal buffer stores no message.  <a href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ae61480c2f471e5621b7322b555b8b59c">More...</a><br /></td></tr>
<tr class="separator:ae61480c2f471e5621b7322b555b8b59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a872f82f1d39162c96e92d95ca978a708"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a872f82f1d39162c96e92d95ca978a708">channel_peek_pt2pt_mpsc_buf</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch)</td></tr>
<tr class="memdesc:a872f82f1d39162c96e92d95ca978a708"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peeks at the channel and signals if messages can be sent (sender process calls) or received (receiver process calls).  <a href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a872f82f1d39162c96e92d95ca978a708">More...</a><br /></td></tr>
<tr class="separator:a872f82f1d39162c96e92d95ca978a708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9750e70a131aeebd2c9ac5aa5cc6bd56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a9750e70a131aeebd2c9ac5aa5cc6bd56">channel_free_pt2pt_mpsc_buf</a> (<a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *ch)</td></tr>
<tr class="memdesc:a9750e70a131aeebd2c9ac5aa5cc6bd56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates the channel and all allocated members.  <a href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a9750e70a131aeebd2c9ac5aa5cc6bd56">More...</a><br /></td></tr>
<tr class="separator:a9750e70a131aeebd2c9ac5aa5cc6bd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header of PT2PT MPSC BUF Channel. </p>
<dl class="section author"><dt>Author</dt><dd>Toni Hollfelder (<a href="#" onclick="location.href='mai'+'lto:'+'Ton'+'i.'+'Hol'+'lf'+'eld'+'er'+'@un'+'i-'+'bay'+'re'+'uth'+'.d'+'e'; return false;">Toni.<span style="display: none;">.nosp@m.</span>Holl<span style="display: none;">.nosp@m.</span>felde<span style="display: none;">.nosp@m.</span>r@un<span style="display: none;">.nosp@m.</span>i-bay<span style="display: none;">.nosp@m.</span>reut<span style="display: none;">.nosp@m.</span>h.de</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-04-13 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>CC BY 4.0 (<a href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a>)</dd></dl>
<p>This PT2PT MPSC BUF channel implementation uses the buffered send mode of MPI. To bookmark the count of sent elements the sender process stores the current buffer size, decrements it for every sent element and increments it for every received acknowledgement message from the receiver. To assert a correct usage of the buffered send mode <a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#a642dc8e94d264c52eee124c07f20796f" title="Updates the properties of a passed MPI_Channel of type PT2PT MPSC BUF and returns it.">channel_alloc_pt2pt_mpsc_buf()</a> needs to append enough memory for the receiver and the sender. The sender process checks for incoming acknowledgment messages and sends the element. To guarantee a fair and starvation-free implementation the receiver process iterates over all senders starting from the last sender rank it received from, checks for incoming elements, receives the element and sends an acknowledgment message. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a642dc8e94d264c52eee124c07f20796f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642dc8e94d264c52eee124c07f20796f">&#9670;&nbsp;</a></span>channel_alloc_pt2pt_mpsc_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a>* channel_alloc_pt2pt_mpsc_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the properties of a passed <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type PT2PT MPSC BUF and returns it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> allocated with <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to a valid <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> with updated properties if updating was successful and NULL otherwise </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns NULL if appending the buffer failed. </dd>
<dd>
Every sender can send n messages until the buffer is exhausted. This means that n * |sender| data messages can arrive at the receiver without calling <a class="el" href="_m_p_i___channel_8c.html#a09096d2a9b8839df93b789ddc554545c" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive()</a> in between. </dd></dl>

</div>
</div>
<a id="a9750e70a131aeebd2c9ac5aa5cc6bd56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9750e70a131aeebd2c9ac5aa5cc6bd56">&#9670;&nbsp;</a></span>channel_free_pt2pt_mpsc_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_free_pt2pt_mpsc_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates the channel and all allocated members. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type PT2PT MPSC BUF. <br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if deallocation was successful, -1 otherwise. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function returns -1 if resizing of the buffer for MPI_Bsend() failed. </dd></dl>

</div>
</div>
<a id="a872f82f1d39162c96e92d95ca978a708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a872f82f1d39162c96e92d95ca978a708">&#9670;&nbsp;</a></span>channel_peek_pt2pt_mpsc_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_peek_pt2pt_mpsc_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Peeks at the channel and signals if messages can be sent (sender process calls) or received (receiver process calls). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type PT2PT MPSC BUF. <br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the sender process calls it returns the current number of elements which can be sent. If the receiver process calls it returns 1 if a message can be received and 0 if no message can be received. If an error occures it returns -1. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns -1 if internal problems with MPI related functions happen. </dd>
<dd>
Since MPI will only let you check if and not how many messages can be received (MPI_Iprobe()) this function cannot return the number of buffered messages to the receiver. </dd></dl>

</div>
</div>
<a id="ae61480c2f471e5621b7322b555b8b59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae61480c2f471e5621b7322b555b8b59c">&#9670;&nbsp;</a></span>channel_receive_pt2pt_mpsc_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_receive_pt2pt_mpsc_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> from the channel and stores them starting at the adress the void pointer holds. Calling <a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ae61480c2f471e5621b7322b555b8b59c" title="Receives the numbers of bytes of a data element specified in channel_alloc() from the channel and sto...">channel_receive_pt2pt_mpsc_buf()</a> blocks only if no element has arrived and the internal buffer stores no message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type PT2PT MPSC BUF. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to a memory adress of which size bytes will be received to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if receiving was successful, -1 otherwise. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns -1 if internal problems with MPI related functions happend. </dd></dl>

</div>
</div>
<a id="ad089f57ac83ba8704b352fff962c4caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad089f57ac83ba8704b352fff962c4caa">&#9670;&nbsp;</a></span>channel_send_pt2pt_mpsc_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int channel_send_pt2pt_mpsc_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the numbers of bytes of a data element specified in <a class="el" href="_m_p_i___channel_8c.html#aa8c734c22b85cf3b6833402b8b3c7b31" title="Allocates and returns a fully constructed MPI_Channel with passed parameter as channel properties.">channel_alloc()</a> starting at the adress the void pointer holds into the channel. Calling <a class="el" href="_p_t2_p_t___m_p_s_c___b_u_f_8h.html#ad089f57ac83ba8704b352fff962c4caa" title="Sends the numbers of bytes of a data element specified in channel_alloc() starting at the adress the ...">channel_send_pt2pt_mpsc_buf()</a> blocks only if the channel buffer has reached the channel capacity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td>Pointer to a <a class="el" href="struct_m_p_i___channel.html">MPI_Channel</a> of type PT2PT MPSC BUF. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to a memory adress of which size bytes will be sent from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if sending was successful, -1 otherwise. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Returns -1 if internal problems with MPI related functions happend. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
